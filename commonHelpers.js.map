{"version":3,"file":"commonHelpers.js","sources":["../src/js/modals.js","../src/js/about-book-modal.js"],"sourcesContent":["import { createModal } from './about-book-modal';\n\n\n\nconst idModal = document.querySelector('.about-book-modal');\nconst closeModalBtn = document.querySelector('#modal-close');\nconst fireBaseBackdrop = document.querySelector('.fire-base-backdrop');\nconst idBackdropModal = document.querySelector('.js-backdrop-modal');\n\n\n\nfunction openModalId(e) {\n\n        e.preventDefault();\n        const bookId = this.getAttribute('data-book-id');\n        idModal.classList.remove('is-hidden');\n        idBackdropModal.classList.remove('is-hidden');  \n        console.log(bookId);\n        createModal(bookId);\n\n}\n\nfunction closeModalId() {\n  idModal.classList.add('is-hidden');\n  idBackdropModal.classList.add('is-hidden');\n  // allModal.innerHTML = ''\n}\n\ncloseModalBtn.addEventListener('click', closeModalId);\n\ndocument.addEventListener('keydown', function (event) {\n  if (event.key === 'Escape') {\n    closeModalId();\n  }\n});\n\nidBackdropModal.addEventListener('click', function (event) {\n  if (event.target === idBackdropModal) {\n    closeModalId();\n  }\n});\n\n\nexport { openModalId };\n\n","import { openModalId } from './modals';\n\nimport amazonPng from '../img/modal/amazon.png';\n\nimport appleBookPng from '../img/modal/applebook.png';\n\n\nconst allModal = document.querySelector('#allModal');\n\nconst storageButton = document.querySelector('.add-storage-button');\n\nconst removeStorageBtn = document.querySelector('.remove-modal-btn');\n\nconst storageDescription = document.querySelector('.storage-description');\n\nconst STORAGE_KEY = 'storage-data';\n\n\nstorageButton.addEventListener('click', onStorageAdd);\n\nremoveStorageBtn.addEventListener('click', onStorageDelete);\n\nasync function createModal(bookId) {\n  allModal.innerHTML = '';\n\n  try {\n    const data = await fetchBookById(bookId);\n\n    storageCheck();\n\n    createMarkup(data);\n\n    return data;\n  } catch (error) {\n    console.error('Error', error);\n\n    throw error;\n  }\n}\n\nasync function fetchBookById(bookId) {\n  try {\n    storageObj = {};\n\n    const response = await fetch(\n      `https://books-backend.p.goit.global/books/${bookId}`\n    );\n\n    const data = await response.json();\n\n    storageObj = {\n      book_image: data.book_image,\n\n      title: data.title,\n\n      author: data.author,\n\n      marketAmazon: data.buy_links[0].url,\n\n      marketAppleBooks: data.buy_links[1].url,\n\n      marketBookshop: data.buy_links[4].url,\n\n      list_name: data.list_name,\n\n      id: data._id,\n    };\n\n    return data;\n  } catch (error) {\n    console.error('Error', error);\n\n    throw error;\n  }\n}\n\nfunction storageCheck() {\n  const storageArr = JSON.parse(localStorage.getItem(STORAGE_KEY));\n\n  const idToFind = storageObj.id;\n\n  if (!storageArr || storageArr.length === 0) {\n    storageButton.style.display = 'block';\n\n    removeStorageBtn.style.display = 'none';\n\n    return;\n  } else {\n    const objToFind = storageArr.find(obj => obj.id === idToFind);\n\n    if (!objToFind) {\n      storageButton.style.display = 'block';\n\n      removeStorageBtn.style.display = 'none';\n    } else {\n      storageButton.style.display = 'none';\n\n      removeStorageBtn.style.display = 'block';\n    }\n  }\n}\n\nfunction createMarkup(data) {\n  const bookModalImage = data.book_image;\n\n  const bookTitle = data.title;\n\n  const bookAuthor = data.author;\n\n  const marketAmazon = data.buy_links[0].url;\n\n  const marketAppleBooks = data.buy_links[1].url;\n\n  const bookDescription = data.description;\n\n  const html = ` <div class=\"modal\" id=\"bookModal\">\n        <img src=\"${bookModalImage}\" alt=\"Book Cover\" class=\"image-about-book-modal\">\n        <div class=\"modal-text\">\n        <h2 id=\"modalTitle\" class=\"title-about-book-modal\">${bookTitle}</h2>\n        <p class=\"author-about-book-modal\"> ${bookAuthor}</p>\n        <p class=\"text-about-book-modal\">${bookDescription}</p>\n        <div id=\"platformLinks\">\n        <ul class=\"shop-modal-list\">\n        <li class=\"shop-modal-item\">\n          <a href=\"${marketAmazon}\" target=\"_blank\">\n          <img width=\"62\" height=\"19\" src=\"${amazonPng}\"alt=\"Amazon\"/>\n          </a>\n        </li>\n        <li class=\"shop-modal-item\"><a href=\"${marketAppleBooks}\" target=\"_blank\">\n        <img width=\"33\" height=\"32\" src=\"${appleBookPng}\" alt=\"AppleBooks\"/>\n        </a>\n        </li>\n        </ul>\n        </div>\n        </div>`;\n  allModal.innerHTML = html;\n}\n\nlet storageArr = [];\n\nlet storageObj = {};\n\nfunction onStorageAdd() {\n  // const realStorageArr = JSON.parse(localStorage.getItem(STORAGE_KEY));\n\n  const dataToSave = storageObj;\n\n  if (!realStorageArr || realStorageArr.length === 0) {\n    storageArr.push(dataToSave);\n\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(storageArr));\n  } else {\n    realStorageArr.push(dataToSave);\n\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(realStorageArr));\n  }\n\n  storageDescription.textContent =\n    'Сongratulations! You have added the book to the shopping list. To delete, press the button “Remove from the shopping list”.';\n\n  storageCheck();\n}\n\nfunction onStorageDelete() {\n  // storageDescription.textContent = '';\n\n  // const idToDelete = storageObj.id;\n\n  // const storageArr = JSON.parse(localStorage.getItem(STORAGE_KEY));\n\n  // const indexToDelete = storageArr.findIndex(obj => obj.id === idToDelete);\n\n  // storageArr.splice(indexToDelete, 1);\n\n  // localStorage.setItem(STORAGE_KEY, JSON.stringify(storageArr));\n\n  localStorage.removeItem(localStorage.getItem(STORAGE_KEY))\n\n\n  storageCheck();\n}\n\n\nexport { createModal };\n\n"],"names":["idModal","closeModalBtn","idBackdropModal","closeModalId","event","storageButton","removeStorageBtn","storageDescription","STORAGE_KEY","onStorageAdd","onStorageDelete","storageCheck","storageArr","idToFind","storageObj","obj","dataToSave"],"mappings":"ssBAIA,MAAMA,EAAU,SAAS,cAAc,mBAAmB,EACpDC,EAAgB,SAAS,cAAc,cAAc,EAClC,SAAS,cAAc,qBAAqB,EACrE,MAAMC,EAAkB,SAAS,cAAc,oBAAoB,EAenE,SAASC,GAAe,CACtBH,EAAQ,UAAU,IAAI,WAAW,EACjCE,EAAgB,UAAU,IAAI,WAAW,CAE3C,CAEAD,EAAc,iBAAiB,QAASE,CAAY,EAEpD,SAAS,iBAAiB,UAAW,SAAUC,EAAO,CAChDA,EAAM,MAAQ,UAChBD,GAEJ,CAAC,EAEDD,EAAgB,iBAAiB,QAAS,SAAUE,EAAO,CACrDA,EAAM,SAAWF,GACnBC,GAEJ,CAAC,ECjCgB,SAAS,cAAc,WAAW,EAEnD,MAAME,EAAgB,SAAS,cAAc,qBAAqB,EAE5DC,EAAmB,SAAS,cAAc,mBAAmB,EAE7DC,EAAqB,SAAS,cAAc,sBAAsB,EAElEC,EAAc,eAGpBH,EAAc,iBAAiB,QAASI,CAAY,EAEpDH,EAAiB,iBAAiB,QAASI,CAAe,EAwD1D,SAASC,GAAe,CACtB,MAAMC,EAAa,KAAK,MAAM,aAAa,QAAQJ,CAAW,CAAC,EAEzDK,EAAWC,EAAW,GAE5B,GAAI,CAACF,GAAcA,EAAW,SAAW,EAAG,CAC1CP,EAAc,MAAM,QAAU,QAE9BC,EAAiB,MAAM,QAAU,OAEjC,MACJ,MACsBM,EAAW,KAAKG,GAAOA,EAAI,KAAOF,CAAQ,GAO1DR,EAAc,MAAM,QAAU,OAE9BC,EAAiB,MAAM,QAAU,UANjCD,EAAc,MAAM,QAAU,QAE9BC,EAAiB,MAAM,QAAU,OAOvC,CAsCA,IAAIM,EAAa,CAAA,EAEbE,EAAa,CAAA,EAEjB,SAASL,GAAe,CAGtB,MAAMO,EAAaF,EAEf,CAAC,gBAAkB,eAAe,SAAW,GAC/CF,EAAW,KAAKI,CAAU,EAE1B,aAAa,QAAQR,EAAa,KAAK,UAAUI,CAAU,CAAC,IAE5D,eAAe,KAAKI,CAAU,EAE9B,aAAa,QAAQR,EAAa,KAAK,UAAU,cAAc,CAAC,GAGlED,EAAmB,YACjB,8HAEFI,GACF,CAEA,SAASD,GAAkB,CAazB,aAAa,WAAW,aAAa,QAAQF,CAAW,CAAC,EAGzDG,GACF"}